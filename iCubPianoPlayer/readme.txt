Code by Diego Mendoza-Halliday, Ph.D.
